# Ø§Ù„Ø´Ø¬Ø±Ø© ðŸŒ³

Ù„ÙŠÙƒÙ† Ù„Ø¯ÙŠÙ†Ø§ **Ø´Ø¬Ø±Ø©** Ù…ÙƒÙˆÙ†Ø© Ù…Ù† $N$ ** Ø¹Ù‚Ø¯Ø© **ØŒ Ù…Ø±Ù‚Ù…Ø© Ù…Ù†  $0$ Ø¥Ù„Ù‰ $N-1$.

Ø§Ù„Ø¹Ù‚Ø¯Ø© $0$ ØªØ¯Ø¹Ù‰ **Ø§Ù„Ø¬Ø°Ø±**.

Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø¹Ù‚Ø¯ØŒ Ø¨Ø§Ø³ØªØ«Ù†Ø§Ø¡ Ø§Ù„Ø¬Ø°Ø±ØŒ Ù„Ù‡Ø§ **Ø£Ø¨** ÙˆØ§Ø­Ø¯

Ù…Ù† Ø£Ø¬Ù„ ÙƒÙ„  $i$, Ø­ÙŠØ« Ø£Ù† $1 \leq i < N$ØŒ

Ø§Ù„Ø£Ø¨ Ù„Ù„Ø¹Ù‚Ø¯Ø© $i$ Ù‡Ùˆ Ø§Ù„Ø¹Ù‚Ø¯Ø© $P[i]$, Ø­ÙŠØ« $P[i] < i$.

Ù„Ù†ÙØªØ±Ø¶ Ø£Ù†  $P[0] = -1$.

Ù„ÙƒÙ„ Ø¹Ù‚Ø¯Ø©  $i$ ($0 \leq i < N$)ØŒ

ØªÙƒÙˆÙ† **Ø§Ù„Ø´Ø¬Ø±Ø© Ø§Ù„ÙØ±Ø¹ÙŠØ©** Ù„Ù„Ø¹Ù‚Ø¯Ø©  $i$ Ù‡ÙŠ Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù† Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„ØªØ§Ù„ÙŠØ©:

\* $i$, Ùˆ

\* Ø£ÙŠ Ø¹Ù‚Ø¯Ø© ØªÙƒÙˆÙ† $i$ Ø£Ø¨Ø§Ù‹ Ù„Ù‡Ø§ØŒ Ùˆ

\* Ø£ÙŠ Ø¹Ù‚Ø¯Ø© ØªÙƒÙˆÙ† $i$ Ø£Ø¨Ø§Ù‹ Ù„Ø£Ø¨ÙŠÙ‡Ø§ (Ø¬Ø¯Ø§Ù‹ Ù„Ù‡Ø§)ØŒ Ùˆ

\* Ø£ÙŠ Ø¹Ù‚Ø¯Ø© ØªÙƒÙˆÙ† $i$ Ø£Ø¨Ø§Ù‹ Ù„Ø¬Ø¯Ù‡Ø§ØŒ Ùˆ

\* ÙˆÙ‡ÙƒØ°Ø§.

ØªØ¸Ù‡Ø± Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø§Ù„Ø£Ø³ÙÙ„ Ù…Ø«Ø§Ù„Ø§Ù‹ Ù„Ø´Ø¬Ø±Ø© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ $N = 6$ Ø¹Ù‚Ø¯Ø©.

ÙƒÙ„ Ø³Ù‡Ù… ÙŠØµÙ„ Ø¹Ù‚Ø¯Ø© Ø¨Ø£Ø¨ÙŠÙ‡Ø§ØŒ Ù…Ø§ Ø¹Ø¯Ø§ Ø§Ù„Ø¬Ø°Ø±ØŒ ÙˆØ§Ù„Ø°ÙŠ Ù„ÙŠØ³ Ù„Ù‡ Ø£Ø¨

Ø§Ù„Ø´Ø¬Ø±Ø© Ø§Ù„ÙØ±Ø¹ÙŠØ© Ù„Ù„Ø¹Ù‚Ø¯Ø© $2$ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù‚Ø¯ $2, 3, 4$ Ùˆ $5$.

Ø§Ù„Ø´Ø¬Ø±Ø© Ø§Ù„ÙØ±Ø¹ÙŠØ© Ù„Ù„Ø¹Ù‚Ø¯Ø© $0$ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ø¹Ù‚Ø¯ ÙÙŠ Ø§Ù„Ø´Ø¬Ø±Ø© ÙˆØ§Ù„ØªÙŠ Ø¹Ø¯Ø¯Ù‡Ø§ $6$ØŒ

ÙˆØ§Ù„Ø´Ø¬Ø±Ø© Ø§Ù„ÙØ±Ø¹ÙŠØ© Ù„Ù„Ø¹Ù‚Ø¯Ø©  $4$ ØªØ­ØªÙˆÙŠ ÙÙ‚Ø· Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù‚Ø¯Ø© $4$.

![](subtrees.png "150")

ÙŠØªÙ… ØªØ®ØµÙŠØµ Ù‚ÙŠÙ… ØºÙŠØ± Ø³Ø§Ù„Ø¨Ø© ØµØ­ÙŠØ­Ø© Ù„ÙƒÙ„ Ø¹Ù‚Ø¯Ø© ÙˆÙ‡ÙŠ ØªÙ…Ø«Ù„ **Ø§Ù„ÙˆØ²Ù†** Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ù‚Ø¯Ø©.

Ù†Ø±Ù…Ø² Ù„ÙˆØ²Ù† Ø§Ù„Ø¹Ù‚Ø¯Ø© $i$ ($0 \leq i < N$) Ø¨Ù€Ù€ $W[i]$.

ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ ÙƒØªØ§Ø¨Ø© Ø¨Ø±Ù†Ø§Ù…Ø¬ Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰  $Q$ Ù…Ù† Ø§Ù„Ø·Ù„Ø¨Ø§ØªØŒ

ÙƒÙ„ Ø·Ù„Ø¨ ÙŠØ­Ø¯Ø¯ Ø¨Ø²ÙˆØ¬ Ù…Ù† Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ØµØ­ÙŠØ­Ø© Ø§Ù„Ù…ÙˆØ¬Ø¨Ø© $(L, R)$.

Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ØªØ­Ø³Ø¨ ÙˆÙÙ‚ Ø§Ù„ØªØ§Ù„ÙŠ:

Ù†Ø¹Ø±Ù Ø¹Ø¯Ø¯ ØµØ­ÙŠØ­ Ù†Ø³Ù…ÙŠÙ‡ **Ù…Ø¹Ø§Ù…Ù„** Ù„ÙƒÙ„ Ø¹Ù‚Ø¯Ø© Ù…Ù† Ø§Ù„Ø´Ø¬Ø±Ø©.

Ù‡Ø°Ø§ Ø§Ù„Ø¹Ø¯Ø¯ ÙŠÙˆØµÙ Ø¨ÙˆØ§Ø³Ø·Ø© Ø³Ù„Ø³Ù„Ø©  $C[0], \ldots, C[N-1]$ØŒ

Ø­ÙŠØ« $C[i]$ ($0 \leq i < N$) Ù‡Ùˆ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ø¹Ù‚Ø¯Ø© $i$.

Ù†Ø³Ù…ÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø³Ù„Ø³Ù„Ø© Ø¨Ù€ **Ø³Ù„Ø³Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„**

Ù†Ù„Ø§Ø­Ø¸ Ø£Ù† Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø¯Ø§Ø®Ù„ Ù‡Ø°Ù‡ Ø§Ù„Ø³Ù„Ø³Ù„Ø© Ù…Ù† Ø§Ù„Ù…Ù…ÙƒÙ† Ø£Ù† ØªÙƒÙˆÙ† Ø³Ø§Ù„Ø¨Ø© ØŒ $0$ØŒ Ø£Ùˆ Ù…ÙˆØ¬Ø¨Ø©.

Ù„ÙƒÙ„ Ø·Ù„Ø¨  $(L, R)$ØŒ

ØªÙƒÙˆÙ† Ø³Ù„Ø³Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ ØµØ§Ù„Ø­Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª ÙƒÙ„ Ø¹Ù‚Ø¯Ø©  $i$ ($0 \leq i < N$)ØŒ

ØªØ­Ù‚Ù‚ Ø§Ù„Ø´Ø±Ø· Ø§Ù„ØªØ§Ù„ÙŠ:

Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ù„Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ø´Ø¬Ø±Ø© Ø§Ù„ÙØ±Ø¹ÙŠØ© Ù„Ù„Ø¹Ù‚Ø¯Ø©  $i$ØŒ Ù„ÙŠØ³ Ø£Ù‚Ù„ Ù…Ù†  $L$ ÙˆÙ„ÙŠØ³ Ø£ÙƒØ¨Ø± Ù…Ù† $R$.

Ù„ÙƒÙ„ Ø³Ù„Ø³Ù„Ø© Ù…Ø¹Ø§Ù…Ù„ Ù…Ø¹Ø·Ø§Ø©  $C[0], \ldots, C[N-1]$ØŒ

\**Ø§Ù„ØªÙƒÙ„ÙØ©** Ù„Ù„Ø¹Ù‚Ø¯Ø©  $i$ Ù‡ÙŠ $|C[i]| \cdot W[i]$ØŒ

Ø­ÙŠØ« $|C[i]|$ ÙŠØ±Ù…Ø² Ù„Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø·Ù„Ù‚Ø© Ù„Ù€ $C[i]$.

Ø£Ø®ÙŠØ±Ø§Ù‹ØŒ **Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„ÙƒÙ„ÙŠØ©** Ù‡ÙŠ Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ Ù„ÙƒÙ„ Ø§Ù„Ø¹Ù‚Ø¯.

ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ Ø­Ø³Ø§Ø¨ **Ø£Ù‚Ù„ ØªÙƒÙ„ÙØ©** ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„ÙŠÙ‡Ø§ Ø¹Ù†Ø¯ Ø£ÙŠ **Ø³Ù„Ø³Ù„Ø© Ù…Ø¹Ø§Ù…Ù„ ØµØ§Ù„Ø­Ø©** Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„ÙƒÙ„ Ø·Ù„Ø¨.

Ù…Ù† Ø§Ù„ÙˆØ§Ø¶Ø­ ÙˆØ¬ÙˆØ¯ Ø³Ù„Ø³Ù„Ø© Ù…Ø¹Ø§Ù…Ù„ ØµØ­ÙŠØ­Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ø£ÙŠ Ø·Ù„Ø¨.

## ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¨Ø±Ù…Ø¬Ø©

ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ§Ø¨Ø¹ÙŠÙ† Ø§Ù„ØªØ§Ù„ÙŠÙŠÙ†:

```

void init(std::vector&lt;int&gt; P, std::vector&lt;int&gt; W)

```

\* $P$, $W$: Ù…ØµÙÙˆÙØ© Ù…Ù† Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØµØ­ÙŠØ­Ø© Ø¨Ø·ÙˆÙ„ $N$

ØªØ­Ø¯Ø¯ Ø§Ù„Ø¢Ø¨Ø§Ø¡ ÙˆØ§Ù„Ø£ÙˆØ²Ø§Ù†.

\* ÙŠØªÙ… Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„ØªØ§Ø¨Ø¹ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø· ÙÙŠ Ø¨Ø¯Ø§ÙŠØ© Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªÙˆØ§ØµÙ„ Ø¨ÙŠÙ† Ù†Ø¸Ø§Ù… Ø§Ù„ØªØµØ­ÙŠØ­ ÙˆØ§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù„ÙƒÙ„ Ø­Ø§Ù„Ø© Ø§Ø®ØªØ¨Ø§Ø±.

```

long long query(int L, int R)

```

\* $L$, $R$: Ø£Ø¹Ø¯Ø§Ø¯ ØµØ­ÙŠØ­Ø© ØªÙ…Ø«Ù„ Ø§Ù„Ø·Ù„Ø¨.

\* Ù‡Ø°Ø§ Ø§Ù„ØªØ§Ø¨Ø¹ ÙŠØ³ØªØ¯Ø¹Ù‰ $Q$ Ø¨Ø¹Ø¯ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„ØªØ§Ø¨Ø¹ `init` Ù„ÙƒÙ„ Ø­Ø§Ù„Ø© Ø§Ø®ØªØ¨Ø§Ø±.

\* ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¹ÙŠØ¯ Ù‡Ø°Ø§ Ø§Ù„ØªØ§Ø¨Ø¹ Ø¬ÙˆØ§Ø¨ Ø§Ù„Ø·Ù„Ø¨.

## Ø§Ù„Ø­Ø¯ÙˆØ¯

\* $1 \leq N \leq 200\,000$

\* $1 \leq Q \leq 100\,000$

\* $P[0] = -1$

\* $0 \leq P[i] < i$ Ù…Ù† Ø£Ø¬Ù„ ÙƒÙ„ $i$ Ø­ÙŠØ« $1 \leq i < N$

\* $0 \leq W[i] \leq 1\,000\,000$ Ù…Ù† Ø£Ø¬Ù„ ÙƒÙ„ $i$ Ø­ÙŠØ« $0 \leq i < N$

\* $1 \leq L \leq R \leq 1\,000\,000$ ÙÙŠ ÙƒÙ„ Ø·Ù„Ø¨

## Ø§Ù„Ù…Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¬Ø²Ø¦ÙŠØ©

| Ø§Ù„Ù…Ø³Ø£Ù„Ø© Ø§Ù„Ø¬Ø²Ø¦ÙŠØ© | Ø§Ù„Ø¹Ù„Ø§Ù…Ø© | Ù‚ÙŠÙˆØ¯ Ø¥Ø¶Ø§ÙÙŠØ© |

| :-----: | :----: | ---------------------- |

|   1     |  $10$  | $Q \leq 10$; $W[P[i]] \leq W[i]$ Ù…Ù† Ø£Ø¬Ù„ ÙƒÙ„ $i$ Ø­ÙŠØ« Ø£Ù† $1 \leq i < N$

|   2     |  $13$  | $Q \leq 10$; $N \leq 2\,000$

|   3     |  $18$  | $Q \leq 10$; $N \leq 60\,000$

|   4     |  $7$   | $W[i] = 1$ Ù…Ù† Ø£Ø¬Ù„ ÙƒÙ„ $i$ Ø­ÙŠØ« Ø£Ù† $0 \leq i < N$

|   5     |  $11$  | $W[i] \leq 1$ Ù…Ù† Ø£Ø¬Ù„ ÙƒÙ„ $i$ Ø­ÙŠØ« Ø£Ù† $0 \leq i < N$

|   6     |  $22$  | $L = 1$

|   7     |  $19$  | Ø¨Ø¯ÙˆÙ† Ù‚ÙŠÙˆØ¯ Ø¥Ø¶Ø§ÙÙŠØ©.

## Ø§Ù„Ø£Ù…Ø«Ù„Ø© 

Ù„ØªÙƒÙ† Ø§Ù„Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©:

```

init([-1, 0, 0], [1, 1, 1])

```

ØªØªÙƒÙˆÙ† Ø§Ù„Ø´Ø¬Ø±Ø© Ù…Ù† $3$ Ø¹Ù‚Ø¯ØŒ Ø§Ù„Ø¬Ø°Ø± ÙˆØ£Ø·ÙØ§Ù„Ù‡Ø§ Ø§Ù„Ù€ $2$ .

ÙˆØ²Ù† ÙƒÙ„ Ø§Ù„Ø¹Ù‚Ø¯  $1$.

```

query(1, 1)

```

ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨ $L = R = 1$ØŒ

Ù‡Ø°Ø§ ÙŠØ¹Ù†ÙŠ Ø£Ù† Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª ÙÙŠ ÙƒÙ„ Ø´Ø¬Ø±Ø© Ø§Ù„ÙØ±Ø¹ÙŠØ© ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† $1$.

Ù„ØªÙƒÙ† Ø³Ù„Ø³Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ $[-1, 1, 1]$.

Ø§Ù„Ø´Ø¬Ø±Ø© ÙˆØ§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„Ø© Ù„Ù‡Ø§ (ÙÙŠ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„Ø§Øª Ø§Ù„Ù…Ø¸Ù„Ù„Ø©) Ù…ÙˆØ¶Ø­Ø© Ø£Ø¯Ù†Ø§Ù‡.

![](ex1.png "150")

Ù…Ù† Ø£Ø¬Ù„ ÙƒÙ„ Ø¹Ù‚Ø¯Ø© $i$ ($0 \leq i < 3$), Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ù„ÙƒÙ„ Ø§Ù„Ø¹Ù‚Ø¯ ÙÙŠ Ø§Ù„Ø´Ø¬Ø±Ø© Ø§Ù„ÙØ±Ø¹ÙŠØ© Ù„Ù„Ø¹Ù‚Ø¯Ø© $i$ ØªØ³Ø§ÙˆÙŠ $1$. 

Ø¥Ø°Ø§Ù‹ØŒ Ø³Ù„Ø³Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ Ù‡Ø°Ù‡ ØµØ§Ù„Ø­Ø©.

ØªØ­Ø³Ø¨ Ø§Ù„ØªÙƒÙ„ÙØ© Ø¨Ø§Ù„Ø´ÙƒÙ„ Ø§Ù„ØªØ§Ù„ÙŠ:

| Ø§Ù„Ø¹Ù‚Ø¯Ø© | Ø§Ù„ÙˆØ²Ù† | Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ | Ø§Ù„ØªÙƒÙ„ÙØ©                      |

| :----: | :----: | :---------: | :-----------------------: |

|   0    |   1    |     -1      | $\mid -1 \mid \cdot 1 = 1$

|   1    |   1    |      1      | $\mid 1 \mid \cdot 1 = 1$

|   2    |   1    |      1      | $\mid 1 \mid \cdot 1 = 1$

Ù„Ø°Ù„Ùƒ Ø§Ù„ØªÙƒÙ„ÙØ© Ù‡ÙŠ $3$.

Ù‡Ø°Ù‡ Ø³Ù„Ø³Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„ÙˆØ­ÙŠØ¯Ø© Ø§Ù„ØµØ§Ù„Ø­Ø©ØŒ Ø­ÙŠØ« ÙŠØ¬Ø¨ Ø¹Ù„Ù‰ Ø§Ù„ØªØ§Ø¨Ø¹ Ø£Ù† ÙŠØ±Ø¬Ø¹ Ù‚ÙŠÙ…Ø© $3$.

```

query(1, 2)

```

Ø£ØµØºØ± ØªÙƒÙ„ÙØ© Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨ Ù‡ÙŠ $2$ØŒ ÙˆÙ‡ÙŠ ØªØ­Ø¯Ø« Ø¹Ù†Ø¯Ù…Ø§ ØªÙƒÙˆÙ† Ø³Ù„Ø³Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ Ù‡ÙŠ $[0, 1, 1]$.

## Sample Grader

Input format:

```

N

P[1]  P[2] ...  P[N-1]

W[0]  W[1] ...  W[N-2] W[N-1]

Q

L[0]  R[0]

L[1]  R[1]

...

L[Q-1]  R[Q-1]

```

where $L[j]$ and $R[j]$

(for $0 \leq j < Q$)

are the input arguments in the $j$-th call to `query`.

Note that the second line of the input contains **only $N-1$ integers**,

as the sample grader does not read the value of $P[0]$.

Output format:

```

A[0]

A[1]

...

A[Q-1]

```

where $A[j]$

(for $0 \leq j < Q$)

is the value returned by the $j$-th call to `query`.
