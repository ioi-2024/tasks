# Tree

Տրված է **ծառ**, որը բաղկացած է $N$ **գագաթներից**, որոնք
 համարակալված են $0$-ից $N-1$ թվերով։
$0$ համարով գագաթը անվանենք ծառի **արմատ**։
Բոլոր գագաթները, բացի արմատից, ունեն **ծնող** գագաթ։
Ցանկացած $i$-ի համար, որտեղ $1 \leq i < N$,
 $i$ համարով գագաթի ծնողը $P[i]$ համարով գագաթն է, որտեղ $P[i] < i$։
Ինչպես նաև $P[0] = -1$։

$i$ համարով գագաթի ($0 \leq i < N$)
 **ենթածառը** գագաթների բազմություն է, որը բաղկացած է հետևյալ գագաթնդրից․
 * $i$,
 * բոլոր գագաթները որոնց ծնողը $i$-ն է,
 * բոլոր գագաթները որոնց ծնողի ծնողը $i$-ն է,
 * բոլոր գագաթները որոնց ծնողի ծնողի ծնողը $i$-ն է,
 * և այլն։

Ներքևի նկարում պատկերված է $N = 6$ գագաթ ունեցող ծառի օրինակ։
Սլաքները տարված են գագաթից դեպի ծնող։
$2$ համարով գագաթի ենթածառը բաղկացած է $2, 3, 4$ և $5$ գագաթներից։
$0$-ի ենթածառը պարունակում է բոլոր $6$ գագաթները, իսկ $4$-ի ենթածառը բաղկացած է միայն $4$-ից։

![](subtrees.png "150")

Գագաթների համար նաև տրված է ոչ բացասական **կշիռ**։
$i$ գագաթի համար ($0 \leq i < N$) այդ կշիռը $W[i]$-ն է։

Ձեր խնդիրն է գրել ծրագիր, որը կպատասխանի $Q$ հատ հարցումների,
 որոնցից յուրաքանչյուրը նկարագրվում է $(L, R)$ թվազույկով։
Հարցման պատասխանը հաշվվում է հետևյալ ձևով։

Դիտարկենք ծառի գագաթներին թվերի որոշակի համապատասխանեցում։ Գագաթին համապատասխանեցված թիվը
 անվանենք **գործակից**։
Այսպիսի համապատասխանեցումը նկարագրվում է $C[0], \ldots, C[N-1]$ հաջորդականությամբ,
 որտեղ $C[i]$ ($0 \leq i < N$) թիվը $i$ համարով գագաթի գործակիցն է։
Այս հաջորդականությունը անվանենք **գործակիցների հաջորդականություն**։
Նկատեք, որ գործակիցը կարող է լինել բացասական, $0$, կամ դրական։

$(L, R)$ հարցման համար,
 գործակիցների հաջորդկանությունը կոչվում է **թույլատրելի**,
  եթե, ցանկացած $i$ ($0 \leq i < N$) գագաթի համար,
 հետևյալ պայմանը տեղի ունի․
 $i$ գագաթի ենթածառում գտնվող գագաթների գործակիցների գումարը
 $L$-ից փոքր չէ և $R$-ից մեծ չէ։

Գործակիցների $C[0], \ldots, C[N-1]$ հաջորդականության համար, $i$ համարով գագաթի **արժեքը** $|C[i]| \cdot W[i]$ է,
 որտեղ $|C[i]|$-ն $C[i]$-ի բացարձակ արժեքն է։
Վերջապես, **գումարային արժեքը** հավասար է բոլոր գագաթների արժեքների գումարին։
Ձեր խնդիրն է, ամեն հարցման համար հաշվել **մինիմալ գումարային արժեքը**, որը կարող է ստացվել ինչոր թույլատրելի համապատասխանեցման դեպքում։

Կարելի է ցույց տալ, որ ցանկացած հարցման համար թույլատրելի համապատասխանեցում գոյություն ունի։

## Իրականացման մանրամանսներ

Դուք պետք է ծրագրավորեք հետևյալ երկու ֆունկցիաները․

```
void init(std::vector&lt;int&gt; P, std::vector&lt;int&gt; W)
```

* $P$, $W$․ $N$ երկարության զանգվածներ, որոնք նկարագրում են գագաթների ծնողները և կշիռները։
* Այս ֆունկցիան կանչվում է ճիշտ մեկ անգամ ամեն թեստում, Ձեր ծրագրի և գրեյդերի փոխգործակցության ամենասկզբում։

```
long long query(int L, int R)
```
* $L$, $R$․հարցումը նկարագրող թվերը։
* Այս ֆունկցիան կանչվում է $Q$ անգամ `init`-ի կանչից հետո։
* Այն պետք է վերադարձնի հարցման պատասխանը։


## Սահմանափակումներ

* $1 \leq N \leq 200\,000$
* $1 \leq Q \leq 100\,000$
* $P[0] = -1$
* $0 \leq P[i] < i$, որտեղ $1 \leq i < N$
* $0 \leq W[i] \leq 1\,000\,000$, որտեղ $0 \leq i < N$
* $1 \leq L \leq R \leq 1\,000\,000$ բոլոր հարցումներում

## Ենթախնդիրներ

| Ենթախնդիր | Միավոր  | Լրացուցիչ սահմանափակումներ |
| :-----: | :----: | ---------------------- |
|   1     |  $10$  | $Q \leq 10$; $W[P[i]] \leq W[i]$, որտեղ $1 \leq i < N$
|   2     |  $13$  | $Q \leq 10$; $N \leq 2\,000$
|   3     |  $18$  | $Q \leq 10$; $N \leq 60\,000$
|   4     |  $7$   | $W[i] = 1$, որտեղ $0 \leq i < N$
|   5     |  $11$  | $W[i] \leq 1$, որտեղ $0 \leq i < N$
|   6     |  $22$  | $L = 1$
|   7     |  $19$  | Լրացուցիչ սահմանափակումներ չկան



## Օրինակներ

Դիտարկենք հետևյալ կանչերը․

```
init([-1, 0, 0], [1, 1, 1])
```
Ծառը բաղկացած է $3$ գագաթներից, արմատը և նրա $2$ զավակները։
Բոլոր գագաթների կշիռը $1$ է։

```
query(1, 1)
```

Այս հարցման ժամանակ․ $L = R = 1$,
 ինչը նշանակում է, որ բոլոր գագաթների ենթածառերի գագաթների գործակիցների գումարը պետք է հավասար լինի $1$-ի։
Դիտարկենք գործակիցների $[-1, 1, 1]$ հաջորդականությունը։
Ծառը և գործակիցները (մոխրագույն ուղանկյունների մեջ) նկարված են ներքևում։

![](ex1.png "150")

Ցանկացած գագաթի ենթածառում գտնվող գագաթների գործակիցների գումարը հավասար է $1$-ի։ 
Այսպիսով համապատասխանեցումը թույլատրելի է, իսկ գումարային արժեքը հաշվվում է հետևյալ ձևով․


| Գագաթ | Կշիռ | Գործակից | Արժեք                      |
| :----: | :----: | :---------: | :-----------------------: |
|   0    |   1    |     -1      | $\mid -1 \mid \cdot 1 = 1$
|   1    |   1    |      1      | $\mid 1 \mid \cdot 1 = 1$
|   2    |   1    |      1      | $\mid 1 \mid \cdot 1 = 1$

Գումարային արժեքը $3$ է։
Սա միակ թույլատրելի համապատասխանեցումն է, այսինքն ֆունկցիան պետք է վարադարձնի  $3$։

```
query(1, 2)
```
Մինիմալ գումարային արժեքը $2$ է,
 և ստացվում է $[0, 1, 1]$ գործակիցներով։

## Գրեյդերի նմուշ

Մուտքային տվյալների ձևաչափը․

```
N
P[1]  P[2] ...  P[N-1]
W[0]  W[1] ...  W[N-2] W[N-1]
Q
L[0]  R[0]
L[1]  R[1]
...
L[Q-1]  R[Q-1]
```

որտեղ $L[j]$ և $R[j]$
 ($0 \leq j < Q$)
 թվերը $j$-րդ հարցման արժեքներն են։
Նկատեք, որ մուտքի երկրորդ տողը պարունակում է **միայն $N-1$** հատ թիվ, քանի որ գրեյդերը չի կարդում $P[0]$-ն։

Ելքային տվյալների ձևաչափը․
```
A[0]
A[1]
...
A[Q-1]
```

,որտեղ $A[j]$
 ($0 \leq j < Q$)
 $j$-րդ հարցմանը ստացված պատասխանն է։
