# Tree

$0$ дөн $N-1$ ге чейин номерленген $N$ **вершинадан** турган **даракты** карап көрөлү. $0$ вершинасы **тамыр** деп аталат. Тамырдан башка ар бир вершинада жалгыз **атасы** бар. Ар бир $i$ үчүн, $1 \leq i < N$ , $i$ вершинасынын атасы $P[i]$ чокусу, мында $P[i] < i$ . Биз ошондой эле $P[0] = -1$ деп ойлойбуз.

Ар кандай вершина үчүн $i$ ( $0 \leq i < N$ ),
 $i$ дын **даракча** бул төмөнкү вершиналардын жыйындысы:
 * $i$ , жана
 * атасы $i$ болгон бардык вершиналар жана
 * атасынын атасы $i$ болгон бардык вершиналар жана
 * атасынын атасынын атасы $i$ болгон бардык вершиналар
 *  ушундай ирээтте уланат.

Алдыдагы сүрөттө 6 вершинадан турган дарак көрсөтүлгөн. Тамырдан башка, ар бир жебе вершинаны өз атасына туташтырат. $2$ вершинасынын даракчасында $2, 3, 5$ жана $5$ вершиналары камтылган. $0$ вершинасынын даракчасында бардык $6$ вершина камтылган. $4$ вершинасынын даракчасында жалгыз $4$ вершинасы камтылган.

![](subtrees.png "150")

Ар бир вершинага терс эмес бүтүн сан салмак берилген. Вершинанын салмагы $i$ үчүн ($0 \leq i < N$) $W[i]$ менен белгиленет.

Сиздин тапшырмаңыз $Q$ суроого жооп берген программа жазышыңыз керек. Ар бир суроо $(L, R)$ атту оң толук сандар менен берилген. Суроолорго жооп кийинкидей саналуусу керек:

Ар бир вершина үчүн **коефицент** деген толук сан бар. Бул сандар $C[0], \ldots, C[N-1]$ ырааттуулугу менен берилген. Ар бир $i$ үчүн ($0 \leq i < N$) $C[i]$ бул $i$ вершинасына берилген коефицент. Мындай ырааттулукту **коефицент ырааттуулугу** деп атайлы. Коефицент ырааттулуктун элементтери терс, нөл же оң болушу мүмкүн экенин эскериңиз. 

$(L, R)$ берилген суроо үчүн, эгер ар бир $i$ үчүн ($0 \leq i < N$) кийинки шарт дал келсе, коефицент ыраттуулугу **туура** деп аталат: Даракчадагы ар вершиналардын коефиценттеринин суммасы $L$ ден кичине эмес жана $R$ ден чоң эмес.

Берилген $C[0], \ldots, C[N-1]$ коефиценттер ырааттулугу үчүн $i$ вершинанын **баасы** бул $|C[i]| \cdot W[i]$. Бул жерде $C[i]$ дын абсолюттук маанисин $|C[i]|$. Акырында **толук баасы** ар бир вершинанын бааларынын суммасы. Сиздин тапшырмаңыз ар бир суроо үчүн кандайдыр бир коефицент ыраттуулугу аркылуу жете ала турган минималдуу толук бааны саноо.

Ар бир суроо үчүн, бир же андан көп туура коефицент ырааттуулуктары бар экенин далилдөө мүмкүн. 

## Implementation Details

Сиз төмөнкү эки процедураны ишке ашырууңуз керек:

```
void init(std::vector&lt;int&gt; P, std::vector&lt;int&gt; W)
```

* $P$ , $W$ : аталарды жана салмактарды көрсөткөн $N$ узундуктагы бүтүн сандардын массивдери.
* Бул процедура ар бир сыноо ишинде грейдер менен сиздин программаңыздын ортосундагы өз ара аракеттенүүнүн башталышында так бир жолу чакырылат.

```
long long query(int L, int R)
```
* $L$ , $R$ : суроону сүрөттөгөн бүтүн сандар.
* Бул процедура ар бир сыноо ишинде `init` чакырылгандан кийин $Q$ жолу деп аталат.
* Бул процедура берилген суроого жооп кайтарышы керек.

## Constraints

* $1 \leq N \leq 200\,000$
* $1 \leq Q \leq 100\,000$
* $P[0] = -1$
* $0 \leq P[i] < i$ ар бир $i$ үчүн $1 \leq i < N$
* $0 \leq W[i] \leq 1\,000\,000$ ар бир $i$ үчүн $0 \leq i < N$
* Ар бир суроодо $1 \leq L \leq R \leq 1\,000\,000$


## Subtasks

| Subtask | Упай | Кошумча чектөөлөр |
| :-----: | :----: | -------------------------------- |
| 1 | $10$ | $Q \leq 10$ ; $W[P[i]] \leq W[i]$ ар бир $i$ үчүн $1 \leq i < N$
| 2 | $13$ | $Q \leq 10$ ; $N \leq 2\,000$
| 3 | $18$ | $Q \leq 10$ ; $N \leq 60\,000$
| 4 | $7$ | $W[i] = 1$ ар бир $i$ үчүн $0 \leq i < N$
| 5 | $11$ | $W[i] \leq 1$ ар бир $i$ үчүн $0 \leq i < N$
| 6 | $22$ | $L = 1$
| 7 | $19$ | Эч кандай кошумча чектөөлөр.

## Examples

Төмөнкү чакырууларды карап көрөлү:

```
init([-1, 0, 0], [1, 1, 1])
```
Дарак $3$ вершиналардан, тамырдан жана анын $2$ балдарынан турат. Бардык вершиналардын салмагы $1$ .

```
query(1, 1)
```

Бул суроодо $L = R = 1$ , бул ар бир даракчадагы коэффициенттердин суммасы $1$ га барабар болушу керек дегенди билдирет. $[-1, 1, 1]$ коэффициентинин ырааттуулугун карап көрөлү. Дарак жана тиешелүү коэффициенттер (көлөкөлүү тик бурчтуктарда) төмөндө сүрөттөлгөн.


![](ex1.png "150")


Ар бир $i$ чокусу үчүн ( $0 \leq i < 3$ ), $i$ ички дарагындагы бардык чокулардын коэффициенттеринин суммасы $1$ га барабар. Демек, бул коэффициент ырааттуулугу жарактуу. Жалпы чыгым төмөнкүдөй эсептелет:


| Вершина | Салмагы | Коэффицент | Баасы |
| :----: | :----: | :---------: | :--------------------------------: |
| 0 | 1 | -1 | $\mid -1 \mid \cdot 1 = 1$
| 1 | 1 | 1 | $\mid 1 \mid \cdot 1 = 1$
| 2 | 1 | 1 | $\mid 1 \mid \cdot 1 = 1$

Демек, жалпы чыгым $3$ түзөт. Бул жалгыз жарактуу коэффициент ырааттуулугу, ошондуктан бул чалуу $3$ кайтарышы керек.

```
query(1, 2)
```
Бул суроонун минималдуу жалпы баасы $2$ болуп саналат жана коэффицент ырааттуулугу $[0, 1, 1]$ болгондо жетишилет.



## Sample Grader

Киргизүү форматы:

```
N
P[1] P[2] ... P[N-1]
W[0] W[1] ... W[N-2] W[N-1]
Q
L[0] R[0]
L[1] R[1]
...
L[Q-1] R[Q-1]
```

мында $L[j]$ жана $R[j]$ ( $0 \leq j < Q$ үчүн) $j$ ынчы `query` чалуудагы киргизүү аргументтери.
Киргизүүнүн экинчи сабында ** $N-1$ гана бүтүн сандар** камтылганын эске алыңыз, анткени үлгү грейдер $P[0]$ маанисин окубайт.

Чыгуу форматы:
```
A[0]
A[1]
...
A[Q-1]
```

мында $A[j]$ ( $0 \leq j < Q$ үчүн) `query` үчүн $j$ -th чалуу менен кайтарылган маани.


