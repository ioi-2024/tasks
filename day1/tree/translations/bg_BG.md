# Дърво

Имате **дърво** състоящо се от $N$ **върха**, номерирани от $0$ до $N-1$.
Връх $0$ е **коренът**, а всеки друг връх има точно един **родител**.
За всяко $i$, такова че $1 \leq i < N$, родителят на връх $i$ е връх $P[i]$,
където $P[i] < i$. Също така, казваме че, $P[0] = -1$.

За всеки връх $i$ ($0 \leq i < N$), поддървото на $i$ е множеството от следните върхове:
 * $i$, и
 * всеки връх с родител равен на $i$, и
 * всеки връх с родител на родителя си равен на $i$, и
 * всеки връх с родител на родителя на родителя си равен на $i$ (но не и балдъзата си), и
 * т.н.

Фигурата по-долу показва примерно дърво, състоящо се от $N = 6$ върха.
Всяка стрелка свързва връх с родителя му (освен корена, който няма родител).
Поддървото на връх $2$ съдържа върхове $2, 3, 4$ и $5$.
Поддървото на връх $0$ съдържа всички $6$ върха в дървото.
Поддървото на връх $4$ съдържа само връх $4$.

![](subtrees.png "150")

Всеки връх има неотрицателно целочислено **тегло**.
Означаваме теглото на връх $i$ ($0 \leq i < N$) с $W[i]$.

Вашата задача е да напишете програма, която да отговори на $Q$ заявки,
всяка от вида $(L, R)$, където $L$ и $R$ са положителни цели числа.
Отговорът на дадена заявка е както следва:

Разглеждаме целочислени **коефициенти** за всички върхове от дървото.
Тези коефициенти са описани от редица $C[0], \ldots, C[N-1]$,
където $C[i]$ ($0 \leq i < N$) е коефициентът на връх $i$.
Да наречем тази редица **редицата от коефициенти**.
Забележете, че елементите на тази редица може да са положителни,
отрицателни или нулеви.

За заявка $(L, R)$, дадена редица от коефициенти е **валидна**,
тогава и само тогава когато, за всеки връх $i$ ($0 \leq i < N$),
сумата на коефициентите в поддървото на връх $i$ е по-голяма
или равна на $L$ и по-малка или равна на $R$.

Забележете, че винаги съществува поне една валидна редица от коефициенти,
за всички възможни заявки $(L, R)$.

За дадена редица от коефициенти $C[0], \ldots, C[N-1]$, **цената** на
връх $i$ е $|C[i]| \cdot W[i]$, където $|C[i]|$ е абсолютната стойност
на $C[i]$. **Общата цена** е сумата на цените на всички върхове.
Вашата задача е, за всяка заявка, да намерите **минималната обща цена**,
която може да се постигне с някоя валидна редица от коефициенти.

## Детайли по имплементацията

Трябва да имплементирате следните две функции:

```
void init(std::vector&lt;int&gt; P, std::vector&lt;int&gt; W)
```

* $P$, $W$: вектори от по $N$ цели числа,
които описват родителите и теглата.
* Тази функция се вика точно веднъж в началото на интеракцията
между грейдъра и Вашата програма.

```
long long query(int L, int R)
```
* $L$, $R$: цели числа, които описват една заявка.
* Тази функция се вика точно $Q$ пъти, но само след като вече е била викната `init`.
* Тя трябва да върне отговора на зададената заявка.

## Ограничения

* $1 \leq N \leq 200\,000$
* $1 \leq Q \leq 100\,000$
* $P[0] = -1$
* $0 \leq P[i] < i$ за всяко $1 \leq i < N$
* $0 \leq W[i] \leq 1\,000\,000$ за всяко $0 \leq i < N$
* $1 \leq L \leq R \leq 1\,000\,000$ за всяка заявка

## Подзадачи

| Подзадача | Точки  | Допълнителни ограничения |
| :-----: | :----: | ---------------------- |
|   1     |  $10$  | $Q \leq 10$; $W[P[i]] \leq W[i]$ за всяко $1 \leq i < N$
|   2     |  $13$  | $Q \leq 10$; $N \leq 2\,000$
|   3     |  $18$  | $Q \leq 10$; $N \leq 60\,000$
|   4     |  $7$   | $W[i] = 1$ за всяко $0 \leq i < N$
|   5     |  $11$  | $W[i] \leq 1$ за всяко $0 \leq i < N$
|   6     |  $22$  | $L = 1$
|   7     |  $19$  | Няма.

## Примери

Да разгледаме следните викания на функции:

```
init([-1, 0, 0], [1, 1, 1])
```

Дървото се състои от $3$ върха: корена и неговите $2$ деца.
Всички върхове имат тегло $1$.

```
query(1, 1)
```

В тази заявка: $L = R = 1$, което значи, че сумата на коефициентите
на върховете във всяко поддърво трябва да е равна на $1$.
Да разгледаме редицата от коефициенти $[-1, 1, 1]$.
Дървото и коефициентите (в сивите правоъгълници) са илюстрирани по-долу:

![](ex1.png "150")

За всеки връх $i$ ($0 \leq i < 3$), сумата на коефициентите на всички
върхове в поддървото на $i$ е равна на $1$. Т.е. редицата е валидна.
Общата цена се смята по следния начин:

| Връх | Тегло | Коефициент | Цена                      |
| :----: | :----: | :---------: | :-----------------------: |
|   0    |   1    |     -1      | $\mid -1 \mid \cdot 1 = 1$
|   1    |   1    |      1      | $\mid 1 \mid \cdot 1 = 1$
|   2    |   1    |      1      | $\mid 1 \mid \cdot 1 = 1$

Следва, че общата цена е $3$. Това е единствената валидна редица,
т.е. отговорът на заявката е $3$.

```
query(1, 2)
```

Минималната обща цена за тази заявка е $2$;
постига се от редицата от коефициенти: $[0, 1, 1]$.

## Локален грейдър

Входен формат:

```
N
P[1]  P[2] ...  P[N-1]
W[0]  W[1] ...  W[N-2] W[N-1]
Q
L[0]  R[0]
L[1]  R[1]
...
L[Q-1]  R[Q-1]
```

където $L[j]$ и $R[j]$ (за $0 \leq j < Q$)
са входните аргументи за $j$-тото викане на `query`.
Забележете, че втория ред на входа съдържа **само $N-1$ цели числа**,
тъй като локалния грейдър не чете стойността на $P[0]$.

Изходен формат:

```
A[0]
A[1]
...
A[Q-1]
```

където $A[j]$ (за $0 \leq j < Q$)
е стойността върната от $j$-тото викане на `query`.
