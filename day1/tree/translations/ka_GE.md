# ხე

განვიხილოთ $N$ რაოდენობის **წვეროსაგან** შემდგარი **ხე**, რომლის წვეროებიც გადანომრილია $0$-დან $(N-1)$-მდე.
წვერო $0$ არის ხის **ფესვი**.
ფესვის გარდა ხის თითოეულ წვეროს ჰყავს ზუსტად ერთი **მშობელი**.
თითოეული ისეთი $i$-სთვის, რომლისთვისაც $1 \leq i < N$,
 $i$ წვეროს მშობელი არის წვერო $P[i]$, სადაც $P[i] < i$.
ჩავთვალოთ, რომ $P[0] = -1$.

თითოეული $i$ წვეროსთვის ($0 \leq i < N$),
 $i$-ს **ქვეხეში** შედიან შემდეგი წვეროები:
 * $i$
 * ნებისმიერი წვერო, რომლის მშობელია $i$;
 * ნებისმიერი წვერო, რომლის მშობლის მშობელია $i$;
 * ნებისმიერი წვერო, რომლის მშობლის მშობლის მშობელია $i$;
 * და ასე შემდეგ.

ქვემოთ მოცემული სურათი გამოხატავს $N = 6$ წვეროსგან შემდგარ ხეს.
თითოეული ისარი აკავშირებს წვეროს მის მშობელთან,
 გარდა ფესვისა, რომელსაც არ ჰყავს მშობელი.
წვერო $2$-ის ქვეხე შეიცავს წვეროებს $2, 3, 4$ და $5$.
წვერო $0$-ის ქვეხე შეიცავს ხის $6$-ვე წვეროს,
 ხოლო წვერო $4$-ის ქვეხე შეიცავს მხოლოდ წვერო $4$-ს.

![](subtrees.png "150")

თითოეულ წვეროს აქვს საკუთარი არაუარყოფითი მთელი **წონა**.
აღვნიშნოთ წვერო $i$-ს წონა ($0 \leq i < N$) $W[i]$-ით.

თქვენი ამოცანაა პასუხი გასცეთ $Q$ ცალ შეკითხვას,
 რომელთაგან თითოეული მოცემულია დადებით მთელ რიცხვთა $(L, R)$ წყვილის სახით.
შეკითხვაზე პასუხი გამოთვლილი უნდა იქნას შემდეგნაირად:

განვიხილოთ ხის თითოეული წვეროსათვის **კოეფიციენტების** შესაბამება.
ასეთი შესაბამება აღიწერება მიმდევრობით $C[0], \ldots, C[N-1]$,
 სადაც $C[i]$ ($0 \leq i < N$) არის კოეფიციენტი, რომელიც შეესაბამება წვერო $i$-ს.
ამ მიმდევრობას დავარქვათ **კოეფიციენტთა მიმდევრობა**.
შევნიშნოთ, რომ კოეფიციენტთა მიმდევრობის წევრები შეიძლება იყვნენ დადებითი, უარყოფითი, ან $0$-ის ტოლი.

$(L, R)$ შეკითხვისთვის,
 კოეფიციენტთა მიმდევრობა არის **ვალიდური**, 
 თუ თითოეული $i$ წვეროსთვის ($0 \leq i < N$)
 მართებულია შემდეგი წინადადება:
 $i$ წვეროს ქვეხეში შემავალი წვეროების კოეფიციენტების ჯამი
 არ არის ნაკლები $L$-ზე და არ აღემატება $R$-ს.

კოეფიციენტთა მოცემული $C[0], \ldots, C[N-1]$ მიმდევრობისთვის,
 წვეროს $i$-ს **ფასი** არის $|C[i]| \cdot W[i]$,
 სადაც $|C[i]|$ აღნიშნავს $C[i]$-ის აბსოლუტურ მნიშვნელობას.
**ჯამური ფასი** ეწოდება ყველა წვეროს ფასების ჯამს.
თქვენი ამოცანაა თითოეული შეკითხვისათვის გამოთვალოთ
 **მინიმალური ჯამური ფასი**, რომელიც შეიძლება მიღწეული იქნას რომელიმე ვალიდურ კოეფიციენტთა მიმდევრობით.

შესაძლებელია ჩვენება იმისა, რომ ნებისმიერი შეკითხვისათვის არსებობს ერთი მაინც ვალიდური კოეფიციენტთა მიმდევრობა.

## იმპლემენტაციის დეტალები

თქვენ უნდა მოახდინოთ შემდეგი ორი პროცედურის იმპლემენტაცია:

```
void init(std::vector&lt;int&gt; P, std::vector&lt;int&gt; W)
```

* $P$, $W$: $N$ ცალი მთელი რიცხვისაგან შემდგარი მასივები, 
   რომლებიც აღწერენ წვეროების მშობლებსა და წონებს;
* პროცედურა გამოძახებული იქნება თითოეული ტესტისთვის ზუსტად ერთხელ
   გრადერსა და თქვენს პროგრამას შორის ინტერაქციის დაწყებისას.

```
long long query(int L, int R)
```
* $L$, $R$: მთელი რიცხვები, რომლებიც აღწერენ შეკითხვას.
* პროცედურა თითოეული ტესტისთვის გამოძახებული იქნება $Q$-ჯერ `init` პროცედურის გამოძახების შემდეგ.
* პროცედურამ უნდა დააბრუნოს პასუხი მოცემული შეკითხვისათვის.


## შეზღუდვები

* $1 \leq N \leq 200\,000$
* $1 \leq Q \leq 100\,000$
* $P[0] = -1$
* $0 \leq P[i] < i$ თითოეული ისეთი $i$-სათვის, რომ $1 \leq i < N$
* $0 \leq W[i] \leq 1\,000\,000$ თითოეული ისეთი $i$-სათვის, რომ $0 \leq i < N$
* $1 \leq L \leq R \leq 1\,000\,000$ თითოეული შეკითხვისათვის

## ქვეამოცანები

| ქვეამოცანა | ქულა  | დამატებითი შეზღუდვები |
| :-----: | :----: | ---------------------- |
|   1     |  $10$  | $Q \leq 10$; $W[P[i]] \leq W[i]$ თითოეული ისეთი $i$-სათვის, რომ $1 \leq i < N$
|   2     |  $13$  | $Q \leq 10$; $N \leq 2\,000$
|   3     |  $18$  | $Q \leq 10$; $N \leq 60\,000$
|   4     |  $7$   | $W[i] = 1$ თითოეული ისეთი $i$-სათვის, რომ $0 \leq i < N$
|   5     |  $11$  | $W[i] \leq 1$ თითოეული ისეთი $i$-სათვის, რომ $0 \leq i < N$
|   6     |  $22$  | $L = 1$
|   7     |  $19$  | დამატებითი შეზღუდვების გარეშე.



## მაგალითი

განვიხილოთ შემდეგი გამოძახებები:

```
init([-1, 0, 0], [1, 1, 1])
```
ხე შედგება $3$ წვეროსაგან, ფესვისა და მისი $2$ შვილისაგან.
თითოეული წვეროს წონა არის $1$.

```
query(1, 1)
```

ამ შეკითხვაში $L = R = 1$,
 რაც ნიშნავს, რომ თითოეულ ქვეხეში კოეფიციენტთა ჯამი უნდა იყოს $1$-ის ტოლი.
განვიხილოთ კოეფიციენტთა მიმდევრობა $[-1, 1, 1]$.
ხე და შესაბამისი კოეფიციენტები (შეფერილ მართკუთხედებში) გამოსახულია ქვემოთ.

![](ex1.png "150")

თითოეული წვერო $i$-სთვის ($0 \leq i < 3$) მის ქვეხეში მდებარე ყველა წვეროს კოეფიციენტთა ჯამი $1$-ის ტოლია. 
შესაბამისად, კოეფიციენტთა მიმდევრობა არის ვალიდური.
ჯამური ფასი გამოითვლება შემდეგნაირად:


| წვერო | წონა | კოეფიციენტი | ფასი                      |
| :----: | :----: | :---------: | :-----------------------: |
|   0    |   1    |     -1      | $\mid -1 \mid \cdot 1 = 1$
|   1    |   1    |      1      | $\mid 1 \mid \cdot 1 = 1$
|   2    |   1    |      1      | $\mid 1 \mid \cdot 1 = 1$

ცხრილი გვიჩვენებს, რომ ჯამური ფასი არის $3$.
ეს არის ერთადერთი ვალიდური კოეფიციენტთა მიმდევრობა,
 შესაბამისად პროცედურამ უნდა დააბრუნოს $3$.

```
query(1, 2)
```
მინიმალური შესაძლო ჯამური ფასი ამ შეკითხვისთვის არის $2$
 და ის მიიღწევა კოეფიციენტთა მიმდევრობით $[0, 1, 1]$.

## სანიმუშო გრადერი

შეტანის ფორმატი:

```
N
P[1]  P[2] ...  P[N-1]
W[0]  W[1] ...  W[N-2] W[N-1]
Q
L[0]  R[0]
L[1]  R[1]
...
L[Q-1]  R[Q-1]
```

სადაც $L[j]$ და $R[j]$
 ($0 \leq j < Q$)
 აღნიშნავენ შეტანის არგუმენტებს `query`-ს $j$-ურ გამოძახებაში.
შევნიშნოთ, რომ შეტანის მეორე ხაზი შეიცავს **მხოლოდ $N-1$ ცალ მთელ რიცხვს**,
 რადგან სანიმუშო გრადერს არ სჭირდება $P[0]$-ის მნიშვნელობის წაკითხვა.

გამოტანის ფორმატი:
```
A[0]
A[1]
...
A[Q-1]
```

სადაც $A[j]$
 ($0 \leq j < Q$)
 არის `query`-ს $j$-ური გამოძახების მიერ დაბრუნებული პასუხი.
