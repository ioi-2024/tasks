# Дрво

Да разгледаме **дрво** што се состои од $N$ **темиња**,
 нумерирани со целите броеви од $0$ до $N-1$.
Темето $0$ се нарекува **корен**.
Секое теме, освен коренот, има точно еден **родител**.
За секое $i$, такво што $1 \leq i < N$,
 родител на темето $i$ е темето $P[i]$, каде $P[i] < i$.
Претпоставуваме дека $P[0] = -1$.

За кое било теме $i$ ($0 \leq i < N$),
 **поддрво** на $i$ е множеството од следните темиња:
 * $i$, и
 * кое било теме чиј родител е темето $i$, и
 * кое било теме чиј родител на родителот е темето $i$, и
 * кое било теме чиј родител на родителот на родителот е темето $i$, и
 * итн.

Сликата подолу прикажува пример за дрво што се состои од $N = 6$ темиња.
Секоја стрелка поврзува дадено теме со неговиот родител,
 освен коренот, кој нема родител.
Поддрвото на темето $2$ ги содржи темињата $2, 3, 4$ и $5$.
Поддрвото на темето $0$ ги содржи сите $6$ темиња на дрвото, а поддрвото на темето $4$ го содржи само темето $4$.

![](subtrees.png "150")

На секое теме му се доделува ненегативна целобројна **тежина**.
Тежината на темето $i$ ($0 \leq i < N$) ќе ја означуваме со $W[i]$.

Ваша задача е да напишете програма којашто ќе одговара на $Q$ прашанки (анг. queries),
 секоја специфицирана со пар од позитивни цели броеви $(L, R)$.
Одговорот на секоја прашанка треба да се пресмета како што е објаснето во продолжение.

Да разгледаме доделување на цел број,
 наречен **коефициент**, на секое теме од дрвото.
Ваквото доделување е опишано со низа $C[0], \ldots, C[N-1]$,
 каде $C[i]$ ($0 \leq i < N$) е коефициентот којшто е доделен на темето $i$.
Оваа низа ќе ја нарекуваме **низа од коефиценти**.
Да забележиме дека елементите на низата од коефициенти може да бидат негативни, $0$, или пак позитивни.

За дадена прашанка $(L, R)$,
 една низа од коефициенти се нарекува **валидна**
 ако, за секое теме $i$ ($0 \leq i < N$),
 важи следниот услов:
 збирот од коефициентите на темињата во поддрвото на темето $i$
 не е помало од $L$ и не е поголемо од $R$.

За дадена низа од коефициенти $C[0], \ldots, C[N-1]$,
 **цената** на теме $i$ е $|C[i]| \cdot W[i]$,
 каде $|C[i]|$ ја означува апсолутната вредност на $C[i]$.
Конечно, **вкупната цена** е збирот од цените на сите темиња.
Ваша задача е да ја пресметате, за секоја прашанка, **минималната вкупна цена** што може да се постигне со некоја валидна низа од коефициенти.

Може да се покаже дека за која било прашанка постои барем една валидна низа од коефициенти.

## Имплементациски детали

Треба да ги имплементирате следните две процедури:

```
void init(std::vector&lt;int&gt; P, std::vector&lt;int&gt; W)
```

* $P$, $W$: низи од цели броеви со должина $N$
   што ги специфицираат родителите и тежините, соодветно.
* Оваа процедура се повикува точно еднаш на почетокот од интеракцијата помеѓу оценувачот и вашата програма во секој тест случај.

```
long long query(int L, int R)
```
* $L$, $R$: цели броеви кои опишуваат прашанка.
* Оваа процедура се повикува точно $Q$ пати по инвокацијата на `init` во секој тест случај.
* Оваа процедура треба да го врати одговорот на дадената прашанка.


## Ограничувања

* $1 \leq N \leq 200\,000$
* $1 \leq Q \leq 100\,000$
* $P[0] = -1$
* $0 \leq P[i] < i$ за секое $i$ такво што $1 \leq i < N$
* $0 \leq W[i] \leq 1\,000\,000$ за секое $i$ такво што $0 \leq i < N$
* $1 \leq L \leq R \leq 1\,000\,000$ во секоја прашанка

## Подзадачи

| Подзадача | Поени  | Дополнителни ограничувања |
| :-----: | :----: | ---------------------- |
|   1     |  $10$  | $Q \leq 10$; $W[P[i]] \leq W[i]$ за секое $i$ такво што $1 \leq i < N$
|   2     |  $13$  | $Q \leq 10$; $N \leq 2\,000$
|   3     |  $18$  | $Q \leq 10$; $N \leq 60\,000$
|   4     |  $7$   | $W[i] = 1$ за секое $i$ такво што $0 \leq i < N$
|   5     |  $11$  | $W[i] \leq 1$ за секое $i$ такво што $0 \leq i < N$
|   6     |  $22$  | $L = 1$
|   7     |  $19$  | Нема дополнителни ограничувања.



## Примери

Да ги разгледаме следните повици:

```
init([-1, 0, 0], [1, 1, 1])
```
Дрвото се состои од $3$ темиња, коренот и неговите $2$ деца.
Сите темиња имаат тежина $1$.

```
query(1, 1)
```

Во оваа прашанка $L = R = 1$,
 што значи дека збирот од коефициентите во секое поддрво мора да биде еднаков на $1$.
Да ја разгледаме низата од коефициенти $[-1, 1, 1]$.
Дрвото и соодветните коефициенти (во засенчени правоаголници) се илустрирани подолу.

![](ex1.png "150")

За секое теме $i$ ($0 \leq i < 3$), збирот од коефициентите на сите темиња во поддрвото на $i$ е еднаков на $1$. 
Според тоа, оваа низа од коефициенти е валидна.
Вкупната цена се пресметува како што следува:


| Теме | Тежина | Коефициент | Цена                      |
| :----: | :----: | :---------: | :-----------------------: |
|   0    |   1    |     -1      | $\mid -1 \mid \cdot 1 = 1$
|   1    |   1    |      1      | $\mid 1 \mid \cdot 1 = 1$
|   2    |   1    |      1      | $\mid 1 \mid \cdot 1 = 1$

Според тоа, вкупната цена е $3$.
Ова е единствената валидна низа од коефициенти,
 па значи овој повик треба да врати $3$.

```
query(1, 2)
```
Минималната вкупна цена за оваа прашанка е $2$,
 и истата се постигнува кога низата од коефициенти е $[0, 1, 1]$.

## Пример-оценувач

Формат на влез:

```
N
P[1]  P[2] ...  P[N-1]
W[0]  W[1] ...  W[N-2] W[N-1]
Q
L[0]  R[0]
L[1]  R[1]
...
L[Q-1]  R[Q-1]
```

каде $L[j]$ и $R[j]$
 (за $0 \leq j < Q$)
 се влезните аргументи во $j$-от повик до `query`.
Да забележиме дека втората линија од влезот содржи **само $N-1$ цели броеви**,
 бидејќи пример-оценувачот не ја чита вредноста $P[0]$.

Формат на излез:
```
A[0]
A[1]
...
A[Q-1]
```

каде $A[j]$
 (за $0 \leq j < Q$)
 е вредноста што е вратена од $j$-от повик до `query`.
