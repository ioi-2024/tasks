# モザイク (Mosaic)

Salma は壁に貼られた粘土のモザイクに色を塗ろうとしている．モザイクは $N \times N$ のグリッド状になっており，$1 \times 1$ の正方形のタイル $N^2$ 個からなる．はじめ，各タイルに色は塗られていない．モザイクの行には上から順に $0$ から $N-1$ までの番号が付けられており，列には左から順に $0$ から $N-1$ までの番号が付けられている．行 $i$ と列 $j$ ($0 \leq i < N$, $0 \leq j < N$) が交わる位置のタイルをタイル $(i,j)$ と呼ぶ．Salma は，それぞれのタイルに白 ($0$ として表す) または黒 ($1$ として表す) の色を塗る．

モザイクに色を塗るとき，Salma はまず，$0$ または $1$ からなる長さ $N$ の数列 $X, Y$ であって $X[0] = Y[0]$ であるようなものを選ぶ．その後，Salma はモザイクの一番上の行 (行 $0$) を数列 $X$ と一致するように塗る．すなわち，タイル $(0, j)$ ($0 \leq j < N$) を色 $X[j]$ で塗る．さらに，Salma はモザイクの一番左の列 (列 $0$) を数列 $Y$ と一致するように塗る．すなわち，タイル $(i, 0)$ ($0 \leq i < N$) を色 $Y[i]$ で塗る．

その後，Salma は色の塗られていないタイルがなくなるまで以下の一連の操作を繰り返す：

* **色の塗られていない** タイル $(i,j)$ であって，上に隣接するタイル (タイル $(i-1, j)$) と左に隣接するタイル (タイル $(i, j-1)$) が **すでに塗られている** ようなものを選ぶ．
* それら $2$ つの隣接するタイルがどちらも白で塗られているなら，タイル $(i,j)$ を黒で塗る．そうでなければ，タイル $(i,j)$ を白で塗る．

最終的に塗られているタイルの色は，Salma がどの順に色を塗るかに関わらず一意であることが証明できる．

Yasmin はモザイクのタイルの色にとても興味があり，Salma に $Q$ 個の質問をする．
質問には $0$ から $Q-1$ までの番号が付けられている．
質問 $k$ ($0 \leq k < Q$) では，Yasmin はモザイクの中の部分長方形を以下によって指定する：
* 部分長方形の一番上の行 $T[k]$ と一番下の行 $B[k]$ ($0 \leq T[k] \leq B[k] < N$)
* 部分長方形の一番左の列 $L[k]$ と一番右の列 $R[k]$ ($0 \leq L[k] \leq R[k] < N$)

質問に対して，Salma は指定された部分長方形の中にある黒いタイルの個数を答えなければならない．すなわち，Salma は黒いタイル $(i, j)$ であって，$T[k] \leq i \leq B[k]$ かつ $L[k] \leq j \leq R[k]$ であるようなものの個数を答えなければならない．

Yasmin の質問に答えるプログラムを実装せよ．

## 実装の詳細

あなたは以下の関数を実装する必要がある．

```
std::vector&lt;long long&gt; mosaic(
	std::vector&lt;int&gt; X, std::vector&lt;int&gt; Y,
    std::vector&lt;int&gt; T, std::vector&lt;int&gt; B,
    std::vector&lt;int&gt; L, std::vector&lt;int&gt; R)
```

* $X, Y$：長さ $N$ の数列であり，それぞれ一番上の行と一番左の列のタイルの色を表す．
* $T, B, L, R$：それぞれ長さ $Q$ の数列であり，Yasmin の質問の内容を表す．
* この関数は，$C[k]$ が質問 $k$ ($0 \leq k < Q$) の答えであるような長さ $Q$ の数列 $C$ を返さなければならない．
* この関数は各テストケースにおいてちょうど $1$ 回だけ呼び出される．

## 制約

* $1 \leq N \leq 200\,000$
* $1 \leq Q \leq 200\,000$
* $X[i] \in \{0, 1\}$ かつ $Y[i] \in \{0, 1\}$ ($0 \leq i < N$)
* $X[0] = Y[0]$
* $0 \leq T[k] \leq B[k] < N$ かつ $0 \leq L[k] \leq R[k] < N$ ($0 \leq k < Q$)

## 小課題

| 小課題 | 得点  | 追加の制約 |
| :-----: | :----: | ---------------------- |
| 1       | $5$    | $N \leq 2; Q \leq 10$
| 2       | $7$    | $N \leq 200; Q \leq 200$
| 3       | $7$    | $T[k] = B[k] = 0$ ($0 \leq k < Q$)
| 4       | $10$   | $N \leq 5000$
| 5       | $8$    | $X[i] = Y[i] = 0$ ($0 \leq i < N$)
| 6       | $22$   | $T[k] = B[k]$ かつ $L[k] = R[k]$ ($0 \leq k < Q$)
| 7       | $19$   | $T[k] = B[k]$ ($0 \leq k < Q$)
| 8       | $22$   | 追加の制約はない．

## 例

次の呼び出しを考える．

```
mosaic([1, 0, 1, 0], [1, 1, 0, 1], [0, 2], [3, 3], [0, 0], [3, 2])
```

この例は以下の図のように表される．左の図はモザイクの各タイルに塗られた色を表し，中央と右の図は，それぞれ質問 $0, 1$ における部分長方形の範囲を表している．

![](example.png "550")

質問に対する答え (すなわち，灰色に塗られた長方形の中の $1$ の数) はそれぞれ $7, 3$ である．したがって，この関数は $[7, 3]$ を返さなければならない．

## 採点プログラムのサンプル

入力形式：

```
N
X[0]  X[1]  ...  X[N-1]
Y[0]  Y[1]  ...  Y[N-1]
Q
T[0]  B[0]  L[0]  R[0]
T[1]  B[1]  L[1]  R[1]
...
T[Q-1]  B[Q-1]  L[Q-1]  R[Q-1]
```

出力形式：

```
C[0]
C[1]
...
C[S-1]
```

ここで，$S$ は `mosaic` が返した数列 $C$ の長さを表す．
